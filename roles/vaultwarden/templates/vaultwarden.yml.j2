# Created with podman-3.4.4
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    bind-mount-options:/home/{{ user_name }}/vaultwarden/ssl_certs: Z
    bind-mount-options:/home/{{ user_name }}/vaultwarden/vw-data: Z
  labels:
    app: vaultwarden
  name: vaultwarden
spec:
  containers:
  - args:
    - /start.sh
    image: docker.io/vaultwarden/server:latest
    name: vaultwarden
    env:
    - name: ROCKET_TLS
      value: '{certs="/ssl_certs/fullchain.pem",key="/ssl_certs/privkey.pem"}'
    ports:
    - containerPort: 80
      hostPort: 10000
    securityContext:
      capabilities:
        drop:
        - CAP_MKNOD
        - CAP_NET_RAW
        - CAP_AUDIT_WRITE
    volumeMounts:
    - mountPath: /data/
      name: home-{{ user_name }}-vaultwarden-vw-data-host-0
    - mountPath: /ssl_certs/
      name: home-{{ user_name }}-vaultwarden-ssl_certs-host-1
  volumes:
  - hostPath:
      path: /home/{{ user_name }}/vaultwarden/vw-data
      type: Directory
    name: home-{{ user_name }}-vaultwarden-vw-data-host-0
  - hostPath:
      path: /home/{{ user_name }}/vaultwarden/ssl_certs
      type: Directory
    name: home-{{ user_name }}-vaultwarden-ssl_certs-host-1
